<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Intro Test</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
        }
        .video-intro-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000;
            z-index: 9998;
            overflow: hidden;
        }
        .video-intro-player {
            width: 100%;
            height: 100%;
            display: block;
            object-fit: cover;
        }
        .controls {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 10000;
            background: rgba(255,255,255,0.9);
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
        }
        .status {
            margin-top: 10px;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 4px;
        }
        button {
            padding: 8px 16px;
            margin: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="video-intro-overlay">
        <video 
            id="videoPlayer"
            class="video-intro-player"
            autoplay 
            muted 
            playsinline
        >
            <source src="/RUIDb230dc15b18c43e88c3dd4db8d70a06f.mp4" type="video/mp4" />
            Your browser does not support the video tag.
        </video>
    </div>

    <div class="controls">
        <h3>Video Intro Test Console</h3>
        <button onclick="playVideo()">Play</button>
        <button onclick="pauseVideo()">Pause</button>
        <button onclick="resetVideo()">Reset</button>
        <button onclick="skipToEnd()">Skip to End</button>
        <div class="status" id="status">Loading...</div>
    </div>

    <script>
        const video = document.getElementById('videoPlayer');
        const status = document.getElementById('status');

        function updateStatus(msg) {
            const time = new Date().toLocaleTimeString();
            status.innerHTML = `[${time}] ${msg}`;
            console.log(`[${time}] ${msg}`);
        }

        // Video event listeners
        video.addEventListener('loadstart', () => updateStatus('üîÑ Video loading started...'));
        video.addEventListener('loadedmetadata', () => {
            updateStatus(`‚úÖ Metadata loaded - Duration: ${video.duration.toFixed(2)}s`);
        });
        video.addEventListener('canplay', () => updateStatus('‚úÖ Video can play'));
        video.addEventListener('playing', () => updateStatus('‚ñ∂Ô∏è Video playing...'));
        video.addEventListener('pause', () => updateStatus('‚è∏Ô∏è Video paused'));
        video.addEventListener('ended', () => {
            updateStatus('‚úÖ Video ended! (This would trigger onboarding)');
            localStorage.setItem('videoIntro.seen.v1', JSON.stringify({ 
                seenAt: new Date().toISOString() 
            }));
        });
        video.addEventListener('error', (e) => {
            const errorMsg = video.error ? `Code ${video.error.code}: ${video.error.message}` : 'Unknown error';
            updateStatus(`‚ùå VIDEO ERROR: ${errorMsg}`);
            console.error('Video error:', video.error);
        });

        // Control functions
        function playVideo() {
            video.play().catch(e => updateStatus(`‚ùå Play failed: ${e.message}`));
        }

        function pauseVideo() {
            video.pause();
        }

        function resetVideo() {
            video.currentTime = 0;
            video.play();
        }

        function skipToEnd() {
            video.currentTime = video.duration - 1;
        }

        // Initial status
        updateStatus('Waiting for video to load...');

        // Check if video intro was already seen
        const seen = localStorage.getItem('videoIntro.seen.v1');
        if (seen) {
            console.log('Video intro already seen:', JSON.parse(seen));
        }
    </script>
</body>
</html>
