/* =========================================================
  3C MALL — UI SYSTEM (SINGLE SOURCE OF TRUTH)
  Concierge · Cost · Community
  NO SCROLL · APP-LIKE · SYMMETRICAL · CLEAN
  WALLPAPER = THEME IMAGE + subtle motion (alive)
  NO GLASS BLUR
========================================================= */

/* =========================================================
  RESET + APP CONSTRAINTS
========================================================= */
*,
*::before,
*::after { box-sizing: border-box; }

html, body{
  height: 100%;
  width: 100%;
  margin: 0;

  /* ✅ true “app-like” */
  overflow: hidden;
  overflow-x: hidden;
}

:root{
  --safeTop: env(safe-area-inset-top, 0px);
  --safeBottom: env(safe-area-inset-bottom, 0px);
}

/* =========================================================
  TOKENS (BRAND FIRST)
========================================================= */
:root{
  /* Brand */
  --blue:#7ee0ff;
  --blueDeep:#1f5dff;
  --gold:#f6dc8a;

  /* Base (fallback if theme image missing) */
  --bg0:#02040a;
  --bg1:#050912;

  /* Default text (dark themes) */
  --text:#f4f6ff;
  --muted:#a9b4d2;
  --muted2:#8d98b6;
  --blackText:#0b0f17;

  /* Theme wallpaper (single source) */
  --theme-image: none;

  /* Readability overlay (above wallpaper, behind UI) */
  --bgOverlayTop: rgba(2,4,10,.18);
  --bgOverlayBottom: rgba(2,4,10,.55);

  /* Energy glows */
  --themeGlowA: rgba(126,224,255,.14);
  --themeGlowB: rgba(246,220,138,.10);
  --themeGlowC: rgba(31,93,255,.12);

  /* Surfaces (tiles, panels) */
  --surface: rgba(255,255,255,.08);
  --surface-strong: rgba(255,255,255,.14);
  --surface-border: rgba(255,255,255,.18);

  --divider: rgba(255,255,255,.14);

  /* Text system */
  --tileTextShadow: none;
  --heroTextShadow: none;
  --tileTitleColor: var(--gold);
}

/* =========================================================
  WALLPAPER (reliable everywhere)
  NOTE: background-size FIXED here (no more 10%)
========================================================= */
body{
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  color: var(--text);
  position: relative;

  background-color: var(--bg0);
  background-image: var(--theme-image);
  background-size: cover;          /* ✅ stretch-to-fit */
  background-position: center;
  background-repeat: no-repeat;

  transform: translateZ(0);
  animation: wallpaper-drift 26s ease-in-out infinite alternate;
}

/* UI sits above wallpaper overlay */
#root{
  height: 100dvh;                 /* ✅ better than 100vh on mobile */
  width: 100%;
  display: flex;
  flex-direction: column;
  isolation: isolate;
  overflow: hidden;
  position: relative;
  z-index: 2;
}

/* =========================================================
  THEMES
  IMPORTANT: assumes data-theme is on <html>
  Images must be in /public/themes/
========================================================= */

/* MIDNIGHT LUX */
html[data-theme="midnight-lux"]{
  --bg0:#02040a;
  --bg1:#050912;

  --text:#f4f6ff;
  --muted:#a9b4d2;
  --muted2:#8d98b6;

  --bgOverlayTop: rgba(2,4,10,.18);
  --bgOverlayBottom: rgba(2,4,10,.72);

  --themeGlowA: rgba(126,224,255,.14);
  --themeGlowB: rgba(246,220,138,.10);
  --themeGlowC: rgba(31,93,255,.12);

  --surface: rgba(255,255,255,.07);
  --surface-strong: rgba(255,255,255,.12);
  --surface-border: rgba(255,255,255,.16);

  --theme-image: none;

  --tileTitleColor: var(--gold);
  --tileTextShadow: none;
  --heroTextShadow: none;
}

/* VELOCITY RED */
html[data-theme="velocity-red"]{
  --bg0:#05050a;
  --bg1:#0b0b14;

  --text:#f7f7ff;
  --muted:#c2c3da;
  --muted2:#a8aac7;

  --bgOverlayTop: rgba(10,0,4,.16);
  --bgOverlayBottom: rgba(10,0,4,.52);

  --themeGlowA: rgba(255, 52, 82, .22);
  --themeGlowB: rgba(246, 220, 138, .12);
  --themeGlowC: rgba(255, 42, 42, .16);

  --surface: rgba(255,255,255,.08);
  --surface-strong: rgba(255,255,255,.14);
  --surface-border: rgba(255,90,90,.35);

  --theme-image: url("/themes/velocity-red-bg.jpg");

  --tileTitleColor: var(--gold);
  --tileTextShadow: none;
  --heroTextShadow: none;
}

/* PEARL LUXE — premium readability */
html[data-theme="pearl-luxe"]{
  --bg0:#0b1018;
  --bg1:#111a26;

  --text:#0f172a;
  --muted:#243041;
  --muted2:#3a4657;
  --blackText:#0b1220;

  --bgOverlayTop: rgba(255,255,255,.16);
  --bgOverlayBottom: rgba(255,255,255,.40);

  --themeGlowA: rgba(180,197,216,.14);
  --themeGlowB: rgba(246,220,138,.12);
  --themeGlowC: rgba(111,143,176,.12);

  --surface: rgba(255,255,255,.86);
  --surface-strong: rgba(255,255,255,.97);
  --surface-border: rgba(210,190,120,.55);

  --theme-image: url("/themes/pearl-luxe-bg.jpg");

  /* Dark gold */
  --tileTitleColor: #7a5a18;

  /* ✅ deeper premium shadow to stop bleed */
  --tileTextShadow:
    -1px 0 rgba(255,255,255,.82),
     1px 0 rgba(255,255,255,.82),
     0 -1px rgba(255,255,255,.82),
     0  1px rgba(255,255,255,.82),
     0  4px  12px rgba(0,0,0,.30),
     0  22px 50px rgba(0,0,0,.36);

  --heroTextShadow:
    -1px 0 rgba(255,255,255,.86),
     1px 0 rgba(255,255,255,.86),
     0 -1px rgba(255,255,255,.86),
     0  1px rgba(255,255,255,.86),
     0  6px  16px rgba(0,0,0,.34),
     0  26px 60px rgba(0,0,0,.40);
}

/* RETRO FUSION — keep your current “perfect” feel */
html[data-theme="retro-fusion"]{
  --bg0:#040610;
  --bg1:#070a18;

  --text:#0b1220;
  --muted:#1f2a3a;
  --muted2:#37465a;
  --blackText:#0b1220;

  --bgOverlayTop: rgba(255,255,255,.08);
  --bgOverlayBottom: rgba(255,255,255,.22);

  --themeGlowA: rgba(120,255,214,.12);
  --themeGlowB: rgba(124,92,255,.10);
  --themeGlowC: rgba(255,207,107,.09);

  --surface: rgba(255,255,255,.30);
  --surface-strong: rgba(255,255,255,.46);
  --surface-border: rgba(0,0,0,.18);

  --theme-image: url("/themes/retro-fusion-bg.jpg");

  --tileTitleColor: var(--gold);
  --tileTextShadow:
    0 1px 0 rgba(255,255,255,.38),
    0 10px 24px rgba(0,0,0,.28);

  --heroTextShadow:
    0 1px 0 rgba(255,255,255,.32),
    0 12px 28px rgba(0,0,0,.30);
}

/* =========================================================
  WALLPAPER OVERLAY (glows + readability)
========================================================= */
body::before{
  content:"";
  position: fixed;
  inset: 0;
  z-index: 0;
  pointer-events: none;

  background:
    radial-gradient(circle at 18% 20%, var(--themeGlowA), transparent 55%),
    radial-gradient(circle at 86% 12%, var(--themeGlowB), transparent 55%),
    radial-gradient(circle at 70% 88%, var(--themeGlowC), transparent 60%),
    linear-gradient(180deg, var(--bgOverlayTop), var(--bgOverlayBottom));

  animation: glow-breathe 10s ease-in-out infinite;
}

@keyframes wallpaper-drift{
  0%   { background-position: 49% 48%; filter: saturate(1.02) contrast(1.02); }
  50%  { background-position: 51% 50%; filter: saturate(1.04) contrast(1.03); }
  100% { background-position: 50% 52%; filter: saturate(1.02) contrast(1.02); }
}

@keyframes glow-breathe{
  0%   { opacity: .92; }
  50%  { opacity: 1.00; }
  100% { opacity: .92; }
}

@media (prefers-reduced-motion: reduce){
  body{ animation: none !important; }
  body::before{ animation: none !important; }
}

/* =========================================================
  APP PAGE BANDS (with safe areas)
========================================================= */
.page{
  height: 100dvh;
  width: 100%;
  display: grid;
  grid-template-rows: auto 1fr auto;
  padding-top: var(--safeTop);
  padding-bottom: var(--safeBottom);
  min-height: 0;
  overflow: hidden;
}

/* Header removed per request */
.brand-emblem{ display: none; }

/* ✅ KEY FIX: internal scroll here, not body */
.page-content{
  padding: 12px;
  display: grid;
  align-content: start;
  gap: 12px;
  overflow-y: auto;
  overflow-x: hidden;
  min-height: 0;
  -webkit-overflow-scrolling: touch;
}

.page-footer{
  padding: 10px 12px 12px;
  border-top: 1px solid var(--divider);
  display: flex;
  gap: 10px;
  justify-content: center;
  overflow: hidden;
}

/* =========================================================
  HERO TILE SCRIM (premium readability)
========================================================= */
.tile-hero{
  position: relative;
  overflow: hidden;
}

.tile-hero::before{
  content:"";
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;

  /* Dark themes scrim */
  background: linear-gradient(
    180deg,
    rgba(0,0,0,.22) 0%,
    rgba(0,0,0,.10) 55%,
    rgba(0,0,0,.22) 100%
  );
}

/* Pearl needs a lighter scrim instead */
html[data-theme="pearl-luxe"] .tile-hero::before{
  background: linear-gradient(
    180deg,
    rgba(255,255,255,.44) 0%,
    rgba(255,255,255,.24) 55%,
    rgba(255,255,255,.42) 100%
  );
}

.tile-hero > *{
  position: relative;
  z-index: 1;
}

/* =========================================================
  GRID (FENG SHUI)
========================================================= */
.fit-grid{
  display: grid;
  grid-template-columns: repeat(2, minmax(0,1fr));
  gap: 12px;
  min-height: 0;
}
.tile-hero{ grid-column: 1 / -1; }

@media (max-width: 560px){
  .fit-grid{ grid-template-columns: 1fr; }
  .page-content{ padding: 10px; gap: 10px; }
}

/* =========================================================
  TILES (NO BLUR)
========================================================= */
.tile{
  border-radius: 18px;
  border: 1px solid var(--surface-border);
  background: linear-gradient(180deg, var(--surface-strong), var(--surface));

  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;

  padding: 14px;
  display: grid;
  gap: 6px;
  min-height: 88px;
  min-width: 0;
  overflow: hidden;
}

.tile-title{
  font-weight: 900;
  letter-spacing: .02em;
  color: var(--tileTitleColor);
  text-shadow: var(--tileTextShadow);
}
.tile-desc{
  font-size: .86rem;
  color: var(--muted);
  line-height: 1.3;
  text-shadow: var(--tileTextShadow);
}

/* =========================================================
  TYPE
========================================================= */
.kicker{
  font-size: .70rem;
  letter-spacing: .18em;
  text-transform: uppercase;
  color: var(--blue);
  text-shadow: var(--heroTextShadow);
}

.h1{
  font-size: 1.55rem;
  font-weight: 900;
  margin-top: 2px;
  text-shadow: var(--heroTextShadow);
}

.sub{
  font-size: .92rem;
  color: var(--muted);
  text-shadow: var(--heroTextShadow);
}

.small{
  font-size: .82rem;
  color: var(--muted2);
  text-shadow: var(--tileTextShadow);
}

/* Pearl: stop “thin bleed” on subtext */
html[data-theme="pearl-luxe"] .kicker,
html[data-theme="pearl-luxe"] .sub,
html[data-theme="pearl-luxe"] .tile-desc,
html[data-theme="pearl-luxe"] .small{
  color: rgba(20, 28, 40, .94);
}

/* =========================================================
  PILL (Mode)
========================================================= */
.pill,
.mode-pill{
  display:inline-flex;
  flex-direction:column;
  gap:2px;
  border-radius: 999px;
  border: 1px solid var(--surface-border);
  background: linear-gradient(180deg, var(--surface-strong), var(--surface));
  padding: 10px 14px;
  font-size: .82rem;
  width: fit-content;
}
.pill span,
.mode-pill span{
  font-size: .68rem;
  letter-spacing: .16em;
  text-transform: uppercase;
  color: var(--muted2);
}
.pill strong,
.mode-pill strong{ color: var(--gold); }

/* =========================================================
  BUTTONS
========================================================= */
.btn{
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: .4rem;
  border-radius: 999px;
  padding: .70rem 1rem;
  font-weight: 900;
  letter-spacing: .08em;
  text-transform: uppercase;
  font-size: .75rem;
  border: none;
  cursor: pointer;
  white-space: nowrap;
  max-width: 100%;
  min-width: 0;
}

.btn-primary{
  background: linear-gradient(135deg, var(--gold), var(--blue));
  color: var(--blackText);
  box-shadow: 0 14px 34px rgba(0,0,0,.28);
}

.btn-secondary{
  background: rgba(255,255,255,.08);
  border: 1px solid rgba(126,224,255,.28);
  color: var(--blue);
}

.btn-ghost{
  background: transparent;
  border: 1px solid rgba(246,220,138,.35);
  color: var(--gold);
}

/* =========================================================
  NO SIDE SCROLL — EVER
========================================================= */
html, body, #root,
.page, .page-content, .fit-grid, .tile,
.cc-panel, .cc-grid,
.modal-panel, .modal-grid{
  width: 100%;
  max-width: 100%;
  overflow-x: hidden;
  min-width: 0;
}

.tile-title, .tile-desc, .kicker, .h1, .sub, .small{
  overflow-wrap: anywhere;
  word-break: break-word;
}

/* =========================================================
  MOBILE DENSITY (premium “tight”)
========================================================= */
@media (max-width: 560px){
  .tile{ padding: 12px; border-radius: 16px; min-height: 76px; }
  .h1{ font-size: 1.38rem; }
  .sub{ font-size: .90rem; }
  .tile-desc{ font-size: .84rem; }
  .btn{ padding: .62rem .9rem; font-size: .72rem; }
}

/* =========================================================
  LANDSCAPE TUNING
========================================================= */
@media (orientation: landscape) and (max-height: 520px){
  .page-content{ padding: 8px 10px; gap: 10px; }
  .h1{ font-size: 1.22rem; }
  .sub{ font-size: .86rem; }
  .tile{ min-height: 68px; }
  .fit-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
}

/* =========================================================
  CONCIERGE OVERLAY (unchanged)
========================================================= */
.cc-overlay{
  position: fixed;
  inset: 0;
  z-index: 999;
  display: grid;
  place-items: center;
  pointer-events: auto;
}

.cc-backdrop{
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,.55);
}

.cc-panel{
  position: relative;
  width: min(980px, calc(100vw - 22px));
  max-height: calc(100dvh - 22px);
  border-radius: 20px;
  border: 1px solid var(--surface-border);
  background: rgba(12, 16, 26, .94);
  box-shadow: 0 24px 72px rgba(0,0,0,.55);
  overflow: hidden;
  display: grid;
  grid-template-rows: auto 1fr;
}

.cc-head{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 14px 14px;
  border-bottom: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
}

.cc-head-left{
  display: flex;
  align-items: center;
  gap: 12px;
  min-width: 0;
}

.cc-badge{
  height: 38px;
  width: 38px;
  border-radius: 999px;
  display: grid;
  place-items: center;
  font-weight: 900;
  letter-spacing: .08em;
  color: var(--blackText);
  background: linear-gradient(135deg, var(--gold), var(--blue));
  flex: 0 0 auto;
}

.cc-title{
  font-weight: 900;
  letter-spacing: .02em;
  font-size: 1.05rem;
  color: #fff;
}
.cc-sub{
  font-size: .72rem;
  letter-spacing: .16em;
  text-transform: uppercase;
  color: rgba(255,255,255,.72);
}

.cc-actions{
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.cc-body{
  padding: 14px;
  display: grid;
  gap: 12px;
  overflow: auto;
}

.cc-grid{
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 12px;
}
@media (max-width: 560px){
  .cc-grid{ grid-template-columns: 1fr; }
}

.cc-choice{
  text-align: left;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  padding: 14px;
  cursor: pointer;
  transition: transform .18s ease, filter .18s ease, border-color .18s ease;
  color: #fff;
  min-height: 78px;
}

.cc-choice:hover{
  transform: translateY(-2px);
  filter: brightness(1.04);
  border-color: rgba(126,224,255,.28);
}

.cc-choice-title{
  font-weight: 900;
  letter-spacing: .02em;
  color: var(--gold);
  margin-bottom: 4px;
}

.cc-choice-desc{
  color: rgba(255,255,255,.78);
  font-size: .88rem;
  line-height: 1.3;
}

.cc-pill{
  position: fixed;
  z-index: 998;
  right: 14px;
  bottom: 14px;
  display: inline-flex;
  align-items: center;
  gap: 10px;
  border-radius: 999px;
  padding: .72rem .95rem;
  border: 1px solid rgba(126,224,255,.28);
  background: rgba(12,16,26,.92);
  color: #fff;
  box-shadow: 0 18px 44px rgba(0,0,0,.45);
  cursor: pointer;
}

.cc-pill-badge{
  height: 28px;
  width: 28px;
  border-radius: 999px;
  display: grid;
  place-items: center;
  font-weight: 900;
  letter-spacing: .08em;
  color: var(--blackText);
  background: linear-gradient(135deg, var(--gold), var(--blue));
}

.cc-pill-text{
  font-weight: 900;
  letter-spacing: .08em;
  text-transform: uppercase;
  font-size: .72rem;
}

/* =========================================================
  GUIDED ASSIST OVERLAY (unchanged)
========================================================= */
.ga-overlay{
  position: fixed;
  inset: 0;
  z-index: 1400;
  display: grid;
  place-items: center;
  pointer-events: auto;
}

.ga-backdrop{
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,.62);
}

.ga-panel{
  position: relative;
  width: min(720px, calc(100vw - 22px));
  max-height: calc(100dvh - 22px);
  border-radius: 20px;
  border: 1px solid rgba(255,255,255,.16);
  background: rgba(12, 16, 26, .96);
  box-shadow: 0 24px 72px rgba(0,0,0,.55);
  overflow: hidden;
  display: grid;
  grid-template-rows: auto 1fr;
}

.ga-head{
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 14px;
  border-bottom: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
}

.ga-badge{
  height: 40px;
  width: 40px;
  border-radius: 12px;
  display: grid;
  place-items: center;
  font-weight: 900;
  letter-spacing: .08em;
  color: var(--blackText);
  background: linear-gradient(135deg, var(--gold), var(--blue));
  flex: 0 0 auto;
}

.ga-head-text{ min-width: 0; }

.ga-title{
  font-weight: 900;
  letter-spacing: .02em;
  font-size: 1.02rem;
  color: #fff;
}

.ga-sub{
  margin-top: 2px;
  font-size: .88rem;
  color: rgba(255,255,255,.76);
  line-height: 1.25;
}

.ga-x{
  margin-left: auto;
  height: 38px;
  width: 38px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.06);
  color: #fff;
  font-size: 22px;
  line-height: 1;
  cursor: pointer;
}

.ga-body{
  padding: 14px;
  display: grid;
  gap: 12px;
  overflow: auto;
}

.ga-actions{
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.ga-btn{ padding: .72rem 1rem; }

.ga-foot{
  display: flex;
  align-items: center;
  gap: 10px;
  border-top: 1px solid rgba(255,255,255,.10);
  padding-top: 12px;
}

.ga-foot-dot{
  width: 8px;
  height: 8px;
  border-radius: 999px;
  background: rgba(126,224,255,.75);
}

.ga-foot-text{
  color: rgba(255,255,255,.72);
  font-size: .86rem;
}

/* =========================================================
  MODAL (Settings)
========================================================= */
.modal-overlay{
  position: fixed;
  inset: 0;
  z-index: 1200;
  display: grid;
  place-items: center;
  pointer-events: auto;
}

.modal-backdrop{
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,.58);
}

.modal-panel{
  position: relative;
  width: min(980px, calc(100vw - 22px));
  max-height: calc(100dvh - 22px);
  border-radius: 20px;
  border: 1px solid var(--surface-border);
  background: rgba(12, 16, 26, .96);
  box-shadow: 0 24px 72px rgba(0,0,0,.55);
  overflow: hidden;
  display: grid;
  grid-template-rows: auto 1fr auto;
}

.modal-head{
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  padding: 14px;
  border-bottom: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
}

.modal-title{
  font-weight: 900;
  letter-spacing: .02em;
  font-size: 1.05rem;
  color: #fff;
}
.modal-sub{
  font-size: .72rem;
  letter-spacing: .16em;
  text-transform: uppercase;
  color: rgba(255,255,255,.72);
}

.modal-body{
  padding: 14px;
  overflow: auto;
  display: grid;
  gap: 14px;
}

.modal-foot{
  padding: 12px 14px 14px;
  border-top: 1px solid rgba(255,255,255,.10);
  display: flex;
  justify-content: flex-end;
}

.modal-section-title{
  font-weight: 900;
  letter-spacing: .06em;
  text-transform: uppercase;
  color: var(--gold);
  margin-bottom: 10px;
}

.modal-grid{
  display: grid;
  grid-template-columns: repeat(2, minmax(0,1fr));
  gap: 12px;
}

@media (max-width: 560px){
  .modal-grid{ grid-template-columns: 1fr; }
}

.modal-choice{
  text-align: left;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  padding: 14px;
  cursor: pointer;
  color: #fff;
}

.modal-choice[data-on="true"]{
  border-color: rgba(246,220,138,.45);
  box-shadow: 0 14px 34px rgba(0,0,0,.35);
}

.modal-choice-title{
  font-weight: 900;
  color: var(--gold);
  margin-bottom: 4px;
}

.modal-choice-desc{
  font-size: .86rem;
  color: rgba(255,255,255,.72);
}
